version: "3"
services:

    nginx:
        
        image: nginx:1.17
        ports:
            - "443:443"
            - "80:80"
        env_file:
            - .env
        volumes:
            - ./default.conf:/etc/nginx/templates/default.conf.template
            - ./nginx/conf.d:/etc/nginx/conf.d
            - ./nginx/code:/code
        entrypoint: /bin/sh -c "envsubst '\$SERVER_NAME' < /etc/nginx/templates/default.conf.template > /etc/nginx/conf.d/default.conf && nginx -g 'daemon off;'"
